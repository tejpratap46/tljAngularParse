<div data-ng-controller="MyFormController">
	<form ng-submit="add()">
		<input type="text" name="field" ng-model="field">
		<input type="submit" value="Submit">
	</form>
</div>

// movie list
<div class="row">
    <div class="col-sm-4 col-md-3 col-lg-2" style="height: 440px;" data-ng-repeat="movie in movies track by $index">
        <div class="thumbnail">
            <a href="#/movie/view/{{movie.id + '/' + movie.title}}">
               <div style="height: 275px; overflow: hidden;">
                    <img style="width: 100%;" src="{{'http://image.tmdb.org/t/p/w185' + movie.poster_path}}" alt="{{movie.title}}">
                </div>
                <div class="caption">
                    <div style="margin-top: -40px; opacity: 0.9;" class="center"><button style="height:60px; width:60px; font-size: 1.5em;" class="btn btn-success bold round-button">{{movie.vote_average}}</button></div>
                    <h4 class="center ellipsis" title="{{movie.title}}">{{movie.title}}</h4>
                    <p class="center ellipsis">{{movie.release_date}}</p>
                </div>
            </a>
            <div class="center">
                <div class="btn-group" style="margin-top: -20px;">
                    <button class="movieWatchlist btn {{movie.watchlistClass}} glyphicon glyphicon-plus" title="Add To Watchlist" data-ng-click="watchlist($index, movie)"></button>
                    <button class="movieWatched btn {{movie.watchedClass}} glyphicon glyphicon-ok" title="Mark As Watched" data-ng-click="watched($index, movie)"></button>
                    <button class="movieLiked btn {{movie.likedClass}} glyphicon glyphicon-heart" title="Like This" data-ng-click="like($index, movie)"></button>
                    <button class="btn btn-primary glyphicon glyphicon-play" title="Play Trailer" data-ng-click="trailer($index, movie)"></button>
                </div>
            </div>
        </div>
    </div>
</div>

app = angular.module('tlj');

app.controller('userMovieController', function($scope){
    
    var currentUser = Parse.User.current();
    if (currentUser) {
    }else{
        window.location.hash = '#/';
    }
    
    var MovieWatchList = Parse.Object.extend("MovieWatched");
    var query = new Parse.Query(MovieWatchList);
    
    $('.notification').first().text('Loading...').show('fast');
    
    query.equalTo("is_deleted", false);
    query.limit(1000);
    query.descending("updatedAt");
    query.find({
    success: function(results) {
        var moviesTemp = [];
        userMoviesWatched = results;
        userMoviesWatchedNames = [];
        for (var i=0; i< results.length; i++){
            userMoviesWatchedNames.push(results[i].get('title'));
        }
        results.forEach(function(object){
            moviesTemp.push({
                title: object.get('title'),
                poster_path: object.get('poster_path'),
                vote_average: object.get('vote_average'),
                release_date: object.get('release_date'),
                id: object.get('tmdb_id')
            });
        });
        
        for(var i=0;i<moviesTemp.length;i++){
            var index = $.inArray(userMoviesWatched[i].get('title'), userMoviesWatchlistNames);
            if (index >= 0){
                moviesTemp[i].watchlistClass = "btn-danger";
            }else{
                moviesTemp[i].watchlistClass = "btn-success";
            }
            index = $.inArray(userMoviesWatched[i].get('title'), userMoviesWatchedNames);
            if (index >= 0){
                moviesTemp[i].watchedClass = "btn-danger";
            }else{
                moviesTemp[i].watchedClass = "btn-info";
            }
            index = $.inArray(userMoviesWatched[i].get('title'), userMoviesLikedNames);
            if (index >= 0){
                moviesTemp[i].likedClass = "btn-danger";
            }else{
                moviesTemp[i].likedClass = "btn-warning";
            }
        }
        $scope.movies = moviesTemp;
        $scope.$apply;
        console.log($scope.movies);
        $('.notification').first().hide('fast');
    },
    error: function(error) {
        $('.notification').first().text('Error ' + error).show('fast').delay(3000).hide('fast');}
    });
    
    $scope.watchlist = function($index,movie){
        addMovieWatchlist($index,movie.id,movie.title,movie.poster_path,movie.genre_ids,movie.release_date,movie.vote_average);
    }
    
    $scope.watched = function($index,movie){
        addMovieWatched($index,movie.id,movie.title,movie.poster_path,movie.genre_ids,movie.release_date,movie.vote_average);
    }
    
    $scope.trailer = function($index,movie){
        showMovieTrailer($index,movie.id);
    }
    
    $scope.like = function($index,movie){
        addMovieLiked($index,movie.id,movie.title,movie.poster_path,movie.genre_ids,movie.release_date,movie.vote_average);
    }
});